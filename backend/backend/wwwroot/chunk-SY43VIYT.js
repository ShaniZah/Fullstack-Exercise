import{a as O,b as j}from"./chunk-63UWHVVF.js";import{c as S,e as v}from"./chunk-FIXLXSQB.js";import{a as W,b as q,e as A,f as D}from"./chunk-MDSJCAGU.js";import{a as I,d as T,e as L,f as k,g as x,h as E,j as N,k as P,l as F,m as R}from"./chunk-NO66PUKX.js";import{C as B}from"./chunk-JVMS6NBD.js";import{Cb as p,Db as u,Ea as a,Eb as g,Ja as l,Pa as h,Ta as M,Za as d,_b as _,ac as b,fb as o,gb as i,jc as c,nb as w,ob as y,yb as s,zb as C}from"./chunk-M4PHA4DX.js";function G(m,n){if(m&1&&(o(0,"mat-error"),s(1),i()),m&2){let e=y();a(),C(e.errorMessage)}}var V=class m{constructor(n,e){this.router=n;this.authService=e}username="";password="";errorMessage="";lockTimer;locked=!1;countdown=0;login(){if(this.locked)return;let n={username:this.username,password:this.password};this.authService.login(n).subscribe({next:()=>{this.errorMessage="",clearInterval(this.lockTimer),this.locked=!1,this.router.navigate([c.root,c.dashboard])},error:e=>{e.status===401?this.errorMessage="Invalid username or password":e.status===423?this.errorMessage="Too many attempts. Try again in 1 minute":this.errorMessage="Something went wrong. Please try again later."}})}startLockoutTimer(n){this.locked=!0,this.countdown=n,this.errorMessage=`Too many attempts. Try again in ${this.countdown}s`,this.lockTimer=setInterval(()=>{this.countdown--,this.countdown<=0?(clearInterval(this.lockTimer),this.locked=!1,this.errorMessage=""):this.errorMessage=`Too many attempts. Try again in ${this.countdown}s`},1e3)}static \u0275fac=function(e){return new(e||m)(l(S),l(v))};static \u0275cmp=h({type:m,selectors:[["app-login"]],decls:15,vars:4,consts:[[3,"ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","name","username","required","",3,"ngModelChange","ngModel"],["matInput","","type","password","name","password","required","",3,"ngModelChange","ngModel"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[4,"ngIf"]],template:function(e,t){e&1&&(o(0,"mat-card")(1,"h2"),s(2,"Login"),i(),o(3,"form",0),w("ngSubmit",function(){return t.login()}),o(4,"mat-form-field",1)(5,"mat-label"),s(6,"Username"),i(),o(7,"input",2),g("ngModelChange",function(r){return u(t.username,r)||(t.username=r),r}),i()(),o(8,"mat-form-field",1)(9,"mat-label"),s(10,"Password"),i(),o(11,"input",3),g("ngModelChange",function(r){return u(t.password,r)||(t.password=r),r}),i()(),o(12,"button",4),s(13," Login "),i(),M(14,G,2,1,"mat-error",5),i()()),e&2&&(a(7),p("ngModel",t.username),a(4),p("ngModel",t.password),a(),d("disabled",t.locked),a(2),d("ngIf",t.errorMessage))},dependencies:[b,_,R,F,D,A,W,q,P,E,I,T,L,N,x,k,j,O,B],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f5f5f5}mat-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:2rem;box-shadow:0 4px 10px #0000001a}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}button[_ngcontent-%COMP%]{width:100%}"]})};export{V as LoginComponent};
