import{a as D,b as O}from"./chunk-ZXAJCFQX.js";import{$ as h,Aa as p,Ba as u,Ca as g,Gb as P,Hb as F,Nb as R,Ob as W,Q as a,Ra as C,Rb as q,Sb as A,Ta as _,U as l,X as f,Yb as j,_a as b,bb as v,ca as d,cb as S,fb as I,gb as T,hb as L,ia as i,ib as k,ja as o,jb as x,lb as E,mb as N,na as M,oa as w,wa as s,xa as y}from"./chunk-ZWUYHGBN.js";function V(m,n){if(m&1&&(i(0,"mat-error"),s(1),o()),m&2){let e=w();a(),y(e.errorMessage)}}var B=class m{constructor(n,e){this.router=n;this.authService=e}username="";password="";errorMessage="";failedAttempts=0;lockTimer;locked=!1;countdown=0;login(){if(this.locked)return;let n={username:this.username,password:this.password};this.authService.login(n).subscribe({next:()=>{this.errorMessage="",clearInterval(this.lockTimer),this.locked=!1,this.router.navigate(["/dashboard"])},error:e=>{e.status===401?this.errorMessage="Invalid username or password":e.status===423?this.errorMessage="Too many attempts. Try again in 1 minute":this.errorMessage="Something went wrong. Please try again later."}})}startLockoutTimer(n){this.locked=!0,this.countdown=n,this.errorMessage=`Too many attempts. Try again in ${this.countdown}s`,this.lockTimer=setInterval(()=>{this.countdown--,this.countdown<=0?(clearInterval(this.lockTimer),this.locked=!1,this.errorMessage=""):this.errorMessage=`Too many attempts. Try again in ${this.countdown}s`},1e3)}static \u0275fac=function(e){return new(e||m)(l(b),l(v))};static \u0275cmp=f({type:m,selectors:[["app-login"]],decls:15,vars:4,consts:[[3,"ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","name","username","required","",3,"ngModelChange","ngModel"],["matInput","","type","password","name","password","required","",3,"ngModelChange","ngModel"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[4,"ngIf"]],template:function(e,t){e&1&&(i(0,"mat-card")(1,"h2"),s(2,"Login"),o(),i(3,"form",0),M("ngSubmit",function(){return t.login()}),i(4,"mat-form-field",1)(5,"mat-label"),s(6,"Username"),o(),i(7,"input",2),g("ngModelChange",function(r){return u(t.username,r)||(t.username=r),r}),o()(),i(8,"mat-form-field",1)(9,"mat-label"),s(10,"Password"),o(),i(11,"input",3),g("ngModelChange",function(r){return u(t.password,r)||(t.password=r),r}),o()(),i(12,"button",4),s(13," Login "),o(),h(14,V,2,1,"mat-error",5),o()()),e&2&&(a(7),p("ngModel",t.username),a(4),p("ngModel",t.password),a(),d("disabled",t.locked),a(2),d("ngIf",t.errorMessage))},dependencies:[_,C,F,P,A,q,R,W,N,x,S,I,T,E,k,L,O,D,j],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f5f5f5}mat-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:2rem;box-shadow:0 4px 10px #0000001a}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}button[_ngcontent-%COMP%]{width:100%}"]})};export{B as LoginComponent};
