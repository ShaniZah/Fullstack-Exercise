import{a as D,b as O}from"./chunk-ZXAJCFQX.js";import{$ as h,Aa as p,Ba as u,Ca as g,Gb as N,Hb as P,Nb as F,Ob as R,Q as r,Ra as _,Rb as W,Sb as q,Ta as y,U as l,X as f,Yb as j,_a as v,bb as b,ca as d,cb as S,fb as I,gb as L,hb as k,ia as t,ib as T,ja as i,jb as x,lb as A,mb as E,na as M,oa as w,wa as a,xa as C}from"./chunk-ZWUYHGBN.js";function V(s,m){if(s&1&&(t(0,"mat-error"),a(1),i()),s&2){let o=w();r(),C(o.errorMessage)}}var B=class s{constructor(m,o){this.router=m;this.authService=o}username="";password="";errorMessage="";failedAttempts=0;lockTimer;locked=!1;countdown=0;login(){if(this.locked)return;let m={username:this.username,password:this.password};this.authService.login(m).subscribe({next:o=>{this.errorMessage="",this.failedAttempts=0,clearInterval(this.lockTimer),this.router.navigate(["/dashboard"])},error:()=>{this.failedAttempts++,this.failedAttempts>=3?(this.locked=!0,this.countdown=60,this.errorMessage=`Locked. Try again in ${this.countdown}s.`,this.lockTimer=setInterval(()=>{this.countdown--,this.countdown<=0?(clearInterval(this.lockTimer),this.failedAttempts=0,this.locked=!1,this.errorMessage=""):this.errorMessage=`Locked. Try again in ${this.countdown}s.`},1e3)):this.errorMessage=`Invalid credentials (${this.failedAttempts}/3)`}})}static \u0275fac=function(o){return new(o||s)(l(v),l(b))};static \u0275cmp=f({type:s,selectors:[["app-login"]],decls:15,vars:4,consts:[[3,"ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","name","username","required","",3,"ngModelChange","ngModel"],["matInput","","type","password","name","password","required","",3,"ngModelChange","ngModel"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[4,"ngIf"]],template:function(o,e){o&1&&(t(0,"mat-card")(1,"h2"),a(2,"Login"),i(),t(3,"form",0),M("ngSubmit",function(){return e.login()}),t(4,"mat-form-field",1)(5,"mat-label"),a(6,"Username"),i(),t(7,"input",2),g("ngModelChange",function(n){return u(e.username,n)||(e.username=n),n}),i()(),t(8,"mat-form-field",1)(9,"mat-label"),a(10,"Password"),i(),t(11,"input",3),g("ngModelChange",function(n){return u(e.password,n)||(e.password=n),n}),i()(),t(12,"button",4),a(13," Login "),i(),h(14,V,2,1,"mat-error",5),i()()),o&2&&(r(7),p("ngModel",e.username),r(4),p("ngModel",e.password),r(),d("disabled",e.locked),r(2),d("ngIf",e.errorMessage))},dependencies:[y,_,P,N,q,W,F,R,E,x,S,I,L,A,T,k,O,D,j],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f5f5f5}mat-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:2rem;box-shadow:0 4px 10px #0000001a}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}button[_ngcontent-%COMP%]{width:100%}"]})};export{B as LoginComponent};
